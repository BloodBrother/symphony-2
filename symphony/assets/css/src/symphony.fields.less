/**
 * Symphony Fields
 *
 * This file contains styles for the widespread field component
 * and its elements (inputs of all sorts, labels and legends, etc.)
 * It sets base styles for multiple generic elements. Field authors
 * should follow its structural conventions to tap into its styling.
 *
 * @since Symphony 4.0.0
 */

@import "variables";

.field {
	// --standard-frame-border-radius: 0px;
	// --standard-side-rhythm: 0px;

	/* Set context for possible absolutely positioned elements --------*/
	position: relative;

	/* Prevent line-height in containers by setting all to block --------*/
	>textarea, select, time {
		display: block;
	}

	/* Layout model - enclosed fields, piling without margins --------*/
	border: 1px solid var(--standard-field-border-color);
	box-sizing: border-box;
	margin-bottom: -1px;
	background-color: var(--standard-field-background-color);

	// >input, >textarea, >select {
	// 	--standard-field-border-color: transparent;
	// }

	/* Compensate with padding for labels visually included in fields --------*/
	label {
		&+input[type=text], 
		&+input[type=email], 
		&~input[type=file], 
		&+input[type=number], 
		&+input[type=password], 
		&+input[type=search], 
		&+input[type=url], 
		&+input[type=tel], 
		&+select, 
		&+textarea,
		&+time,
		&+* input[type=text], 
		&+* input[type=email], 
		&+* input[type=file], 
		&+* input[type=number], 
		&+* input[type=password], 
		&+* input[type=search], 
		&+* input[type=url], 
		&+* input[type=tel], 
		&+* select,
		&+* textarea,
		&+* time,
		&~.tab-panel input[type=text], 
		&~.tab-panel input[type=email], 
		&~.tab-panel input[type=file], 
		&~.tab-panel input[type=number], 
		&~.tab-panel input[type=password], 
		&~.tab-panel input[type=search], 
		&~.tab-panel input[type=url], 
		&~.tab-panel input[type=tel], 
		&~.tab-panel select,
		&~.tab-panel textarea {
			padding-top: var(--compensate-for-inner-field-label);
		}
	}

	/* Round corners of extremeties and make sure form inputs inherit these --------*/
	/* Top extremity --------*/
	&:first-of-type {
		border-top-left-radius: var(--standard-field-border-radius);
		border-top-right-radius: var(--standard-field-border-radius);

		label+input[type=text]:first-of-type, 
		label+input[type=email]:first-of-type, 
		label+input[type=file]:first-of-type, 
		label+input[type=number]:first-of-type, 
		label+input[type=password]:first-of-type, 
		label+input[type=search]:first-of-type, 
		label+input[type=url]:first-of-type, 
		label+input[type=tel]:first-of-type, 
		label+select:first-of-type, 
		label+textarea:first-of-type,
		label+* input[type=text]:first-of-type, 
		label+* input[type=email]:first-of-type, 
		label+* input[type=file]:first-of-type, 
		label+* input[type=number]:first-of-type, 
		label+* input[type=password]:first-of-type, 
		label+* input[type=search]:first-of-type, 
		label+* input[type=url]:first-of-type, 
		label+* input[type=tel]:first-of-type, 
		label+* select:first-of-type,
		label+* textarea:first-of-type,
		.tab-panel input[type=text]:first-of-type, 
		.tab-panel input[type=email]:first-of-type, 
		.tab-panel input[type=file]:first-of-type, 
		.tab-panel input[type=number]:first-of-type, 
		.tab-panel input[type=password]:first-of-type, 
		.tab-panel input[type=search]:first-of-type, 
		.tab-panel input[type=url]:first-of-type, 
		.tab-panel input[type=tel]:first-of-type, 
		.tab-panel select:first-of-type,
		.tab-panel textarea:first-of-type {
			border-top-left-radius: inherit;
			border-top-right-radius: inherit;
		}
	}
	/* Bottom extremity --------*/
	&:last-of-type {
		&, 
		label+input[type=text]:last-child, 
		label+input[type=email]:last-child, 
		label+input[type=file]:last-child, 
		label+input[type=number]:last-child, 
		label+input[type=password]:last-child, 
		label+input[type=search]:last-child, 
		label+input[type=url]:last-child, 
		label+input[type=tel]:last-child, 
		label+select:last-child, 
		label+textarea:last-child,
		label+* input[type=text]:last-child, 
		label+* input[type=email]:last-child, 
		label+* input[type=file]:last-child, 
		label+* input[type=number]:last-child, 
		label+* input[type=password]:last-child, 
		label+* input[type=search]:last-child, 
		label+* input[type=url]:last-child, 
		label+* input[type=tel]:last-child, 
		label+* select:last-child,
		label+* textarea:last-child,
		.tab-panel input[type=text]:last-child, 
		.tab-panel input[type=email]:last-child, 
		.tab-panel input[type=file]:last-child, 
		.tab-panel input[type=number]:last-child, 
		.tab-panel input[type=password]:last-child, 
		.tab-panel input[type=search]:last-child, 
		.tab-panel input[type=url]:last-child, 
		.tab-panel input[type=tel]:last-child, 
		.tab-panel select:last-child,
		.tab-panel textarea:last-child {
			border-bottom-left-radius: var(--standard-field-border-radius);
			border-bottom-right-radius: var(--standard-field-border-radius);
		}
	}
	
	label, legend, time {
		margin-left: var(--standard-inner-rhythm);
		margin-right: var(--standard-inner-rhythm);
	}

	time {
		margin-bottom: var(--standard-inner-rhythm);
	}

	/* Labels and their contents --------*/
	label {
		/* Make sure the labels blend with the fields --------*/
		background-color: inherit;
		border-radius: inherit;

		/* Position field titles/labels as if in input --------*/
		height: 0;

		/* Important for the positioning of errors --------*/
		position: static;

		/* Graphical failsafe for fields with input inside labels --------*/
		&:only-child {
			height: auto;
		}
		
		/* Give rhythm space to checkboxes --------*/
		&~input[type=checkbox] {
			margin-top: var(--compensate-for-inner-field-label);
			margin-left: var(--standard-inner-rhythm);
		}

		/* Base styles for label contents --------*/
		>span, >i, >p {
			background-color: inherit;
			padding: 0 var(--spacing-nano);
			line-height: 1.1em;
		}

		/* Label content tag --------*/
		>span {
			top: var(--standard-inner-rhythm);
			position: relative;
			border-radius: var(--radius-small);
			display: inline-block;
			margin-left: calc(-1 * var(--spacing-nano));
			z-index: 1;
		}

		/* Field usage information — floating tooltip model --------*/
		>i {
			bottom: 100%;
			margin-bottom: -1px;
			position: absolute;
			right: -1px;
			max-width: 100%;
			padding-top: var(--spacing-pico);
			margin-right: var(--standard-inner-rhythm);
			border-top: 1px solid var(--standard-field-border-color);
			border-left: 1px solid var(--standard-field-border-color);
			border-right: 1px solid var(--standard-field-border-color);
			box-shadow: var(--shadow-up-smaller);
			font-size: var(--text-smallest);
			border-radius: var(--radius-small) var(--radius-small) 0 0;
			color: inherit;
		}

		/* Error and help content — under field model --------*/
		p {
			top: 100%;
			position: absolute;
			left: -1px;
			max-width: 100%;
			margin-top: -.5em;
			font-size: var(--text-smallest);
			padding-bottom: var(--spacing-pico);
			margin-left: var(--standard-inner-rhythm);
			border-bottom: 1px solid currentColor;
			border-left: 1px solid currentColor;
			border-right: 1px solid currentColor;
			border-radius: 0 0 var(--radius-small) var(--radius-small);

			/* Make sure its over the following field --------*/
			z-index: 2;

			/* Force inline text --------*/
			br {
				display: none;
			}
		}
	}

	/* Give rhythm to basic elements --------*/
	button {
		margin: var(--standard-inner-rhythm);
	}

	/* Give security spacing while still using 100% width --------*/
	img {
		padding: var(--standard-inner-rhythm);
		box-sizing: border-box;
	}

/* Interactive styles --------*/
	/* When the field is not hovered... --------*/
	&:not(:hover) { 
		color: var(--standard-label-color);

		/* Hide usage information --------*/
		label {
			>i {
				opacity: 0;
			}
		}

		/* Give minimal attention to buttons --------*/
		input[type=button],
		input[type=submit],
		button,
		.button  {
			&:not(:focus) {
				background-image: initial;
				background-color: var(--standard-field-background-color);
				color: inherit;
				opacity: 0;
			}
		}
	}

	/* When the field is hovered... --------*/
	&:hover {
		/* Make sure text elements are colored --------*/
		label,
		input[type=text]:hover:not(:focus), 
		input[type=email]:hover:not(:focus), 
		input[type=file]:hover:not(:focus), 
		input[type=number]:hover:not(:focus), 
		input[type=password]:hover:not(:focus), 
		input[type=search]:hover:not(:focus), 
		input[type=url]:hover:not(:focus), 
		input[type=tel]:hover:not(:focus), 
		select:hover:not(:focus), 
		textarea:hover:not(:focus) {
			color: var(--standard-field-hover-color);
		}
	}

	&:focus-within {
		background-color: var(--standard-field-focus-background-color);
	}


/* Readonly style variant --------*/
	&.field-value-readonly {
		--standard-field-hover-color: var(--standard-label-color);

		border-style: dashed;

		* {
			pointer-events: none;
		}
	}

/* Special case for upload fields at large --------*/
	&[class*="upload"] {
		label~* {
			a, input {
				flex-grow: 1;
			}

			input[type=file] {
				padding-top: var(--compensate-for-inner-field-label);
			}

			[type="hidden"]~a {
				display: block;
				color: inherit;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
				flex-shrink: 1;
				flex-basis: 0;
				padding-top: var(--compensate-for-inner-field-label);
				padding-bottom: var(--standard-inner-rhythm);
				margin: 0 var(--standard-inner-rhythm);
			}

			[type="hidden"]~a:hover {
				color: var(--standard-field-hover-color);
			}
		}

		&[class*="upload"] button {
			float: right;
		}

		&[class*="upload"] button+*:not(button) {
			clear: right;
		}
	}


/* Overrides for particular field types --------*/
	&.field-checkbox,
	&.field-upload {
		align-items: center;
	}

	&.field-date {
		position: relative;
	}

	&.field-date .suggestions,
	.tags {
		max-width: initial;
		flex: 100% 0 0;
		position: static;
	}

/* Generic tabs positioning --------*/
	ul.tabs {
		bottom: calc(100%);
		margin: 0;
		margin-left: var(--standard-inner-rhythm);
		background-color: inherit;
		font-size: var(--text-smaller);
		padding-top: var(--spacing-pico);
		z-index: 1;
		left: -1px;
	}

	ul.tabs>li {
		background-color: inherit;
		box-shadow: var(--shadow-up-smaller);
		border-radius: var(--radius-small) var(--radius-small) 0 0;
	}

	&:not(:hover) ul.tabs {
		opacity: 0;
	}

	ul.tabs>li.active {
		border-bottom-color: transparent;
	}


/* Position error message --------*/
	&.invalid { 
		position: relative;
		label+p {
			position: absolute;
			top: -.25em;
			right: 1em;
			min-width: max-content;
			z-index: 1;
		}
		.help {
			right: var(--standard-inner-rhythm);
			left: auto;
		}
	}
}